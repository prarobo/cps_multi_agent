<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T3U3">dist</span>, <span class="var type1" id="S3T1U4">FStar</span>] = findEnergyGame_mod(<span class="var type1" id="S4T2U7">trans</span>,<span class="var type1" id="S5T1U8">F</span>,<span class="var type1" id="S6T43U9">S</span>,<span class="var type1" id="S7T3U10">turn</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%function takes transition relation, accepting states, and states and returns a vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%of distance to acceptance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo" id="T8:U7"><span class="var type1" id="S8T8U13">cF</span> = <span class="mxinfo" id="T8:U9">size(<span class="var type1" id="S5T1U16">F</span>,2)</span></span>; <span class="comment">%cardinality of F</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo" id="T3:U11"><span class="var type1" id="S10T3U20">d</span> = <span class="mxinfo" id="T3:U13"><span class="fcn" id="F157N2:B22">dijkstraGameEff_mod</span>(<span class="var type1" id="S4T2U23">trans</span>,<span class="var type1" id="S5T1U24">F</span>,<span class="var type1" id="S7T3U25">turn</span>)</span></span>; <span class="comment">%call djikstra for each final state</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo" id="T1:U17"><span class="var type1" id="S3T1U28">FStar</span> = <span class="var type1" id="S5T1U29">F</span></span>; <span class="comment">%set FStar to F then prune</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T8:U20"><span class="var type1" id="S12T8U32">numInd</span> = <span class="var type1" id="S8T8U33">cF</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S13T8U36">i</span> = <span class="mxinfo" id="T8:U24">1</span>:<span class="var type1" id="S8T8U39">cF</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">if</span>(<span class="mxinfo" id="T9:U26">~<span class="mxinfo" id="T9:U27">isempty(<span class="mxinfo" id="T1:U28"><span class="var type1" id="S10T3U47">d</span>(<span class="mxinfo" id="T28:U30"><span class="mxinfo" id="T28:U31"><span class="var type1" id="S4T2U50">trans</span>(<span class="mxinfo" id="T8:U33"><span class="var type1" id="S5T1U52">F</span>(<span class="var type1" id="S13T8U53">i</span>)</span>,:)</span>==<span class="mxinfo" id="T8:U36">1</span></span>)</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">        <span class="mxinfo" id="T8:U37"><span class="var type1" id="S15T8U58">minD</span> = <span class="mxinfo" id="T8:U39">min(<span class="mxinfo" id="T3:U40"><span class="var type1" id="S10T3U62">d</span>(<span class="mxinfo" id="T28:U42"><span class="mxinfo" id="T28:U43"><span class="var type1" id="S4T2U65">trans</span>(<span class="mxinfo" id="T8:U45"><span class="var type1" id="S5T1U67">F</span>(<span class="var type1" id="S13T8U68">i</span>)</span>,:)</span>==<span class="mxinfo" id="T8:U48">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T9:U49"><span class="var type1" id="S15T8U74">minD</span> == <span class="mxinfo" id="T8:U51">Inf</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">            <span class="mxinfo" id="T28:U52"><span class="var type1" id="S18T28U79">ind</span> = <span class="mxinfo" id="T28:U54">~(<span class="mxinfo" id="T28:U55"><span class="mxinfo" id="T1:U56"><span class="var type1" id="S3T1U84">FStar</span>(<span class="mxinfo" id="T8:U58">1</span>:<span class="var type1" id="S12T8U87">numInd</span>)</span>==<span class="mxinfo" id="T8:U60"><span class="var type1" id="S5T1U89">F</span>(<span class="var type1" id="S13T8U90">i</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">            <span class="mxinfo" id="T8:U63"><span class="var type1" id="S12T8U93">numInd</span> = <span class="mxinfo" id="T8:U65">sum(<span class="mxinfo" id="T22:U66"><span class="var type1" id="S18T28U97">ind</span>(:)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">            <span class="mxinfo" id="T1:U68"><span class="mxinfo" id="T1:U69"><span class="var type1" id="S3T1U102">FStar</span>(<span class="mxinfo" id="T8:U71">1</span>:<span class="var type1" id="S12T8U105">numInd</span>)</span> = <span class="mxinfo" id="T1:U73"><span class="var type1" id="S3T1U107">FStar</span>(<span class="var type1" id="S18T28U108">ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">            <span class="mxinfo" id="T1:U76"><span class="mxinfo" id="T1:U77"><span class="var type1" id="S3T1U112">FStar</span>(<span class="mxinfo" id="T8:U79"><span class="var type1" id="S12T8U115">numInd</span>+<span class="mxinfo" id="T8:U81">1</span></span>:<span class="mxinfo" id="T8:U82">end</span>)</span> = <span class="mxinfo" id="T8:U83">Inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">            <span class="comment">%FStar = setdiff(FStar,F(i));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo" id="T3:U84"><span class="var type1" id="S2T3U123">dist</span> = <span class="mxinfo" id="T3:U86"><span class="fcn" id="F157N2:B125">dijkstraGameEff_mod</span>(<span class="var type1" id="S4T2U126">trans</span>,<span class="mxinfo" id="T1:U88"><span class="var type1" id="S3T1U128">FStar</span>(<span class="mxinfo" id="T8:U90">1</span>:<span class="var type1" id="S12T8U131">numInd</span>)</span>,<span class="var type1" id="S7T3U132">turn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"></span></span>
</pre>
